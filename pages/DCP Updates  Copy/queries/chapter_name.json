{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "chapter_name",
    "datasource": {
      "name": "lb_web_1",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "lb_web_1",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "DCP Updates  Copy",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "with section_chap as (select sm.section_id, cdm.chapter_tag, cdm.chapter_name, cdm.subject_id from section_master as sm\njoin school_academy as sa\non sa.class_id = sm.class_id and sa.subject_id = {{subject.selectedOptionValue}}\n\njoin school_class_info as sci\non sm.class_id = sci.class_id\n\njoin chapter_details_master as cdm\non cdm.subject_id =  {{subject.selectedOptionValue}} and cdm.std = sci.std and cdm.publication_id = sa.publication_id\nwhere sm.section_id = {{section.selectedOptionValue}})\n\nselect  b2.section_id, b2.chapter_tag, b2.chapter_name, concat(b2.chapter_tag, ' - ',b2.chapter_name) as full_name, b2.theory_percentage_completed, b2.theory_updated_time, b8.test_percent, b4.test_updated_time,stm.name\nfrom (select sc.section_id, sc.chapter_tag, sc.chapter_name, theory_percentage_completed, theory_updated_time from section_chap as sc\n\t\tleft join (\n\t\t\t\twith total_theory_data as (select chapter_tag,count(*) as total_thoey_concepts from public.topic_detail_master \n\t\t\t\tgroup by chapter_tag\n\t\t\t\torder by chapter_tag asc) \n\n\t\t\t\tselect tcd.section_id,tcd.chapter_tag,theory_completed*100/total_thoey_concepts as theory_percentage_completed , theory_updated_time \n\t\t\t\tfrom (SELECT  section_id, chapter_tag ,\n\t\t\t\t\tmax(updated_at) theory_updated_time,count(*) as theory_completed FROM public.course_theory_track ctt\n\t\t\t\t\tWHERE section_id = {{section.selectedOptionValue}}\n\t\t\t\t\tgroup by section_id, chapter_tag\n\t\t\t\t\torder by section_id ,chapter_tag asc )tcd\n\t\t\t\t join total_theory_data ttd on tcd.chapter_tag = ttd.chapter_tag\n\t\t\t\t order by tcd.section_id,tcd.chapter_tag asc) b1\n\t\ton sc.chapter_tag = b1.chapter_tag) b2\n\njoin (select sc.section_id, sc.chapter_tag, b3.test_updated_time from section_chap as sc\nleft join (select section_id,chapter_tag,max(updated_at) as test_updated_time from public.course_test_track\n\t\t\t WHERE section_id = {{section.selectedOptionValue}}\n\t  group by section_id,chapter_tag\n\t  order by chapter_tag asc) b3\non sc.chapter_tag = b3.chapter_tag ) b4\n\non b2.chapter_tag = b4.chapter_tag and b2.section_id = b4.section_id\n\n\nleft join (select sc.section_id, sc.chapter_tag, sc.chapter_name, b7.test_percent from section_chap as sc\nleft join (WITH total_theory_data AS\n\t\t(SELECT chapter_tag,\n\t\t\t\tcount(*) AS total_thoey_concepts\n\t\t\tFROM public.topic_detail_master\n\t\t\tGROUP BY chapter_tag\n\t\t\tORDER BY chapter_tag ASC)\n\n\tselect ttd.chapter_tag, b6.test_completed*100/ttd.total_thoey_concepts as test_percent \n\t\t\t   from total_theory_data as ttd\n\tleft join (select b5.section_id, b5.chapter_tag, array_length(array_agg(distinct b5.concepts), 1) as test_completed \n\t\t\t   from (select ctt.section_id, ctt.chapter_tag, td.test_name,  (unnest(td.cd_id_list)::int) as concepts \n\t\t\t\t\t from test_details as td\n\t\t\t\t\tjoin course_test_track as ctt\n\t\t\t\t\ton ctt.test_id = td.test_id\n\t\t\t\t\twhere ctt.test_schedule_status != 1\n\t\t\t\t\torder by ctt.section_id, ctt.chapter_tag, td.test_name\n\t\t\t\t\t) b5\n\t\t\t\twhere b5.section_id = {{section.selectedOptionValue}}\n\tgroup by b5.section_id, b5.chapter_tag) b6\n\ton ttd.chapter_tag = b6.chapter_tag) b7\non sc.chapter_tag = b7.chapter_tag) b8\non b2.chapter_tag = b8.chapter_tag and b2.section_id = b8.section_id\nleft join public.chapters_handled ch\non b2.chapter_tag = ch.chapter_tag and b2.section_id = ch.section_id\nleft join public.school_teachers_master stm\non ch.teacher_id = stm.teacher_id\n\n",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": false,
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [
      "section.selectedOptionValue",
      "subject.selectedOptionValue"
    ],
    "userSetOnLoad": true,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": []
  },
  "id": "DCP Updates  Copy_chapter_name",
  "deleted": false,
  "gitSyncId": "62f1f707b2f8027edfbfef76_63d0b5413f7cc55e1ac7a582"
}